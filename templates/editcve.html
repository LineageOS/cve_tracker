{% extends "base.html" %}
{% block title %}LineageOS CVE Tracker - Edit {{ cve.cve_name }}{% endblock %}
{% block head %}
  <script src="{{ url_for('static', filename='js/editcve.js') }}"></script>
{% endblock %}
{% block content %}
  <div id="addlink" title="Enter new link" cve_id="{{ cve.id }}">
    <input placeholder="link" type="text" name="link" id="linktoadd"><br/>
    <input placeholder="description" type="text" name="desc" id="linkdesc">
    <div id="addlinkerror"></div>
  </div>

  <div id="editlink" title="Edit">
    Link:<br/>
    <input placeholder="http://" type="text" name="link" id="linktoedit" size="30"><br/>
    Description:<br/>
    <input placeholder="'Patch for version xxx', ..." type="text" name="desc" id="linkeditdesc" size="30">
    <div id="editlinkerror"></div>
  </div>

  <div id="confirmdeletecve" title="Confirm deletion?" cve_name="{{ cve.cve_name }}">
    Are you sure that you want to delete this CVE?<br/>This can <b>not</b> be undone!
  </div>

  <div id="confirmdeletelink" title="Confirm deletion?" link_id="">
    Are you sure that you want to delete this link?<br/>This can <b>not</b> be undone!
    <div id="deletelinkerror"></div>
  </div>

  <div class="card container">
    <div class="back"><a href="javascript:history.back()">back</a></div>
    {% if msg %}
      <div>
        {{ msg }}
      </div>
    {% else %}
      <h3>{{ cve.cve_name }}</h3>
      <div class="actions">
        <button onclick="deletecve()">Delete CVE</button>
      </div>
      <h4>Links</h4>
      <div id="linklist">
        <ul>
        {% for l in links %}
          {% if l.desc %}{% set desc = l.desc %}{% else %}{% set desc = "No description" %}{% endif %}
          <li link="{{ l.link }}" desc="{{ desc }}" id="{{ l.id }}">
            <a class="link" href="{{ l.link }}">{{ l.link }}</a> - 
            <span class="linkdesc">{{ desc }}</span>
            <button onclick="deletelink(this);">Delete</button>
            <button onclick='editlink(this);'>Edit</button>
          </li>
          {% endfor %}
        </ul>
      </div>
      <div class="actions container">
        <button onclick='addlink();'>Add New Link</button>
      </div>
    {% endif %}
  </div>
{% endblock %}
